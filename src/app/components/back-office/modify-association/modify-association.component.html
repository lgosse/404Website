<div class="form" *ngIf="association && associationForm" fxLayout="column">

  <form [formGroup]="associationForm" class="containerX" (ngSubmit)="onSubmit()" novalidate>

    <div class="containerX" fxLayout="row">
      <span fxFlex></span>
      <app-association-card [association]="associationForm.value"></app-association-card>
      <span fxFlex></span>
    </div>

    <div fxLayout="row" class="full-width">
      <span fxFlex class="flex-item"></span>

      <md-accordion class="form__accordion">

        <md-expansion-panel [expanded]="step === 0" (opened)="setStep(0)">
          <md-expansion-panel-header>
            <mat-panel-title>
              Description de {{ association.name }}
            </mat-panel-title>
          </md-expansion-panel-header>
          <div class="containerX" fxLayout="column">
            <md-form-field>
              <input mdInput formControlName="description" type="text" required placeholder="Description" maxlength="50">
              <md-hint align="end">{{associationForm.value.description.length}} / 50</md-hint>
            </md-form-field>
            <md-form-field>
              <input mdInput formControlName="facebookURL" type="text" placeholder="Facebook URL" required>
              <md-error *ngIf="associationForm.get('facebookURL').valid === false">
                URL is invalid
              </md-error>
            </md-form-field>
            <md-form-field>
              <input mdInput formControlName="websiteURL" type="text" placeholder="Website URL">
              <md-error *ngIf="associationForm.get('websiteURL').valid === false">
                URL is invalid
              </md-error>
            </md-form-field>
          </div>
          <md-action-row>
            <button type="button" md-button color="primary" (click)="nextStep()">
              Suivant
            </button>
          </md-action-row>
        </md-expansion-panel>

        <md-expansion-panel [expanded]="step === 1" (opened)="setStep(1)">
          <md-expansion-panel-header>
            <mat-panel-title>
              Coordonnées du président (requis)
            </mat-panel-title>
          </md-expansion-panel-header>
          <app-association-contact-form [group]="associationForm.controls['firstContact']"></app-association-contact-form>
          <md-action-row>
            <button type="button" md-button color="primary" (click)="nextStep()">
              Suivant
            </button>
          </md-action-row>

        </md-expansion-panel>

        <md-expansion-panel [expanded]="step === 2" (opened)="setStep(2)">
          <md-expansion-panel-header>
            <mat-panel-title>
              Coordonnées du Trésorier (optionnel)
            </mat-panel-title>
          </md-expansion-panel-header>
          <app-association-contact-form [group]="associationForm.controls['secondContact']"></app-association-contact-form>
          <md-action-row>
            <button type="button" md-button color="primary" (click)="nextStep()">
              Suivant
            </button>
          </md-action-row>
        </md-expansion-panel>

        <md-expansion-panel [expanded]="step === 3" (opened)="setStep(3)">
          <md-expansion-panel-header>
            <mat-panel-title>
              Coordonnées du Secrétaire (optionnel)
            </mat-panel-title>
          </md-expansion-panel-header>
          <app-association-contact-form [group]="associationForm.controls['thirdContact']"></app-association-contact-form>
        </md-expansion-panel>
      </md-accordion>
      <span fxFlex class="flex-item"></span>

    </div>

    <div fxLayout="row" class="containerX">
      <span fxFlex></span>
      <button md-raised-button class="form__button color__white" color="primary" [disabled]="!associationForm.valid">
        Sauvegarder
      </button>
      <button md-raised-button class="form__button color__white" type="button" color="primary" [disabled]="!associationForm.valid"
        (click)="toggleAssociationPublication()">
        {{ association.published ? 'Retirer du site' : 'Publier sur le site' }}
      </button>
      <span fxFlex></span>
    </div>

  </form>
</div>